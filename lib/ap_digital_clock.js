/**
 * Digital clock
 * @constructor ApDigitalLock
 */

"use strict";

const React = require('react'),
      types = React.PropTypes,
      ReactDOM = require('react-dom'),
      classnames = require('classnames'),
      ApClock = require('./ap_clock'),
      ApDigitalClockMainDisplay = require('./ap_digital_clock_main_display'),
      ApDigitalClockSubDisplay = require('./ap_digital_clock_sub_display'),
      moment = require('moment'),
      PureRenderMixin = require('react-addons-pure-render-mixin'),
      chopcal = require('chopcal'),
      numcal = require('numcal');

/** @lends ApDigitalLock */
let ApDigitalLock = React.createClass({
    displayName: 'ApDigitalLock',

    //--------------------
    // Specs
    //--------------------

    propTypes: {
        showSeconds: types.bool
    },

    mixins: [PureRenderMixin],

    statics: {
        padZero: function (value, len) {
            let result = String(value);
            while (result.length < len) {
                result = "0" + result;
            }
            return result;
        }
    },

    getInitialState: function () {
        return {
            hours: "00",
            minutes: "00",
            seconds: "00",
            size: 256,
            labelWidth: 128
        };
    },

    getDefaultProps: function () {
        return {
            showSeconds: true
        };
    },

    render: function () {
        let s = this,
            state = s.state,
            props = s.props;

        let size = state.size;

        let mainFontSize = parseInt(size * 0.2),
            subFontSize = mainFontSize / 4;

        let boardStyle = {
            width: `${ size }px`,
            height: `${ size }px`
        };

        return React.createElement(
            ApClock,
            { className: classnames("ap-digital-clock", props.className) },
            React.createElement(
                'div',
                { className: 'ap-digital-clock-board', style: boardStyle },
                React.createElement(
                    'div',
                    { className: 'ap-digital-clock-board-inner' },
                    React.createElement(
                        'div',
                        { className: 'ap-digital-clock-display' },
                        React.createElement(ApDigitalClockMainDisplay, { hours: state.hours,
                            minutes: state.minutes,
                            seconds: state.seconds,
                            fontSize: mainFontSize,
                            onSizeChange: s.onMainDisplaySizeChange
                        }),
                        React.createElement(ApDigitalClockSubDisplay, { day: state.day,
                            width: state.labelWidth,
                            fontSize: subFontSize
                        })
                    )
                )
            )
        );
    },

    //--------------------
    // Lifecycle
    //--------------------

    componentWillMount: function () {
        let s = this;
        s._looping = true;
    },

    componentDidMount: function () {
        let s = this,
            props = s.props;

        let padZero = ApDigitalLock.padZero;

        function _loop() {
            if (!s._looping) {
                return;
            }
            let now = new Date();

            s.setState({
                hours: padZero(now.getHours(), 2),
                minutes: padZero(now.getMinutes(), 2),
                seconds: padZero(now.getSeconds(), 2),
                day: moment(now).format('LL')
            });
            window.requestAnimationFrame(_loop);
        }

        window.addEventListener('resize', s.resizeClock);
        _loop();
        s.resizeClock();
    },

    componentWillUnmount: function () {
        let s = this;
        window.removeEventListener('resize', s.resizeClock);
        s._looping = false;
    },

    //------------------
    // Helper
    //------------------

    resizeClock: function () {
        let s = this,
            elm = ReactDOM.findDOMNode(s);
        let size = numcal.min(elm.offsetWidth, elm.offsetHeight);
        s.setState({
            size: size
        });
    },

    onMainDisplaySizeChange: function (sizes) {
        let s = this;
        s.setState({
            labelWidth: sizes.innerWidth
        });
    }

});

module.exports = ApDigitalLock;
//# sourceMappingURL=data:application/json;base64,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TSxDQUFDLGdCQUFnQixDQUFDLFFBQVEsRUFBRSxDQUFDLENBQUMsV0FBVyxDQUFDLENBQUM7QUFDakQsYUFBSyxFQUFFLENBQUM7QUFDUixTQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7S0FDbkI7O0FBRUQsd0JBQW9CLEVBQUUsWUFBWTtBQUM5QixZQUFJLENBQUMsR0FBRyxJQUFJLENBQUM7QUFDYixjQUFNLENBQUMsbUJBQW1CLENBQUMsUUFBUSxFQUFFLENBQUMsQ0FBQyxXQUFXLENBQUMsQ0FBQztBQUNwRCxTQUFDLENBQUMsUUFBUSxHQUFHLEtBQUssQ0FBQztLQUN0Qjs7Ozs7O0FBTUQsZUFBVyxFQUFFLFlBQVk7QUFDckIsWUFBSSxDQUFDLEdBQUcsSUFBSTtZQUNSLEdBQUcsR0FBRyxRQUFRLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ2xDLFlBQUksSUFBSSxHQUFHLE1BQU0sQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLFdBQVcsRUFBRSxHQUFHLENBQUMsWUFBWSxDQUFDLENBQUM7QUFDekQsU0FBQyxDQUFDLFFBQVEsQ0FBQztBQUNQLGdCQUFJLEVBQUUsSUFBSTtTQUNiLENBQUMsQ0FBQztLQUNOOztBQUVELDJCQUF1QixFQUFFLFVBQVUsS0FBSyxFQUFFO0FBQ3RDLFlBQUksQ0FBQyxHQUFHLElBQUksQ0FBQztBQUNiLFNBQUMsQ0FBQyxRQUFRLENBQUM7QUFDUCxzQkFBVSxFQUFFLEtBQUssQ0FBQyxVQUFVO1NBQy9CLENBQUMsQ0FBQztLQUNOOztDQUVKLENBQUMsQ0FBQzs7QUFFSCxNQUFNLENBQUMsT0FBTyxHQUFHLGFBQWEsQ0FBQyIsImZpbGUiOiJhcF9kaWdpdGFsX2Nsb2NrLmpzIiwic291cmNlUm9vdCI6Ii9Vc2Vycy9va3VuaXNoaXRha2EvcHJvamVjdHMvYXBlbWFuLXJlYWN0LWxhYm8vYXBlbWFuLXJlYWN0LWNsb2NrL2xpYi9qc3giLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIERpZ2l0YWwgY2xvY2tcbiAqIEBjb25zdHJ1Y3RvciBBcERpZ2l0YWxMb2NrXG4gKi9cblxuXCJ1c2Ugc3RyaWN0XCI7XG5cbmNvbnN0IFJlYWN0ID0gcmVxdWlyZSgncmVhY3QnKSxcbiAgICB0eXBlcyA9IFJlYWN0LlByb3BUeXBlcyxcbiAgICBSZWFjdERPTSA9IHJlcXVpcmUoJ3JlYWN0LWRvbScpLFxuICAgIGNsYXNzbmFtZXMgPSByZXF1aXJlKCdjbGFzc25hbWVzJyksXG4gICAgQXBDbG9jayA9IHJlcXVpcmUoJy4vYXBfY2xvY2snKSxcbiAgICBBcERpZ2l0YWxDbG9ja01haW5EaXNwbGF5ID0gcmVxdWlyZSgnLi9hcF9kaWdpdGFsX2Nsb2NrX21haW5fZGlzcGxheScpLFxuICAgIEFwRGlnaXRhbENsb2NrU3ViRGlzcGxheSA9IHJlcXVpcmUoJy4vYXBfZGlnaXRhbF9jbG9ja19zdWJfZGlzcGxheScpLFxuICAgIG1vbWVudCA9IHJlcXVpcmUoJ21vbWVudCcpLFxuICAgIFB1cmVSZW5kZXJNaXhpbiA9IHJlcXVpcmUoJ3JlYWN0LWFkZG9ucy1wdXJlLXJlbmRlci1taXhpbicpLFxuICAgIGNob3BjYWwgPSByZXF1aXJlKCdjaG9wY2FsJyksXG4gICAgbnVtY2FsID0gcmVxdWlyZSgnbnVtY2FsJyk7XG5cblxuLyoqIEBsZW5kcyBBcERpZ2l0YWxMb2NrICovXG5sZXQgQXBEaWdpdGFsTG9jayA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtcblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBTcGVjc1xuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIHByb3BUeXBlczoge1xuICAgICAgICBzaG93U2Vjb25kczogdHlwZXMuYm9vbFxuICAgIH0sXG5cbiAgICBtaXhpbnM6IFtcbiAgICAgICAgUHVyZVJlbmRlck1peGluXG4gICAgXSxcblxuICAgIHN0YXRpY3M6IHtcbiAgICAgICAgcGFkWmVybzogZnVuY3Rpb24gKHZhbHVlLCBsZW4pIHtcbiAgICAgICAgICAgIGxldCByZXN1bHQgPSBTdHJpbmcodmFsdWUpO1xuICAgICAgICAgICAgd2hpbGUgKHJlc3VsdC5sZW5ndGggPCBsZW4pIHtcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBcIjBcIiArIHJlc3VsdDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgZ2V0SW5pdGlhbFN0YXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBob3VyczogXCIwMFwiLFxuICAgICAgICAgICAgbWludXRlczogXCIwMFwiLFxuICAgICAgICAgICAgc2Vjb25kczogXCIwMFwiLFxuICAgICAgICAgICAgc2l6ZTogMjU2LFxuICAgICAgICAgICAgbGFiZWxXaWR0aDogMTI4XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgZ2V0RGVmYXVsdFByb3BzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzaG93U2Vjb25kczogdHJ1ZVxuICAgICAgICB9XG4gICAgfSxcblxuICAgIHJlbmRlcjogZnVuY3Rpb24gKCkge1xuICAgICAgICBsZXQgcyA9IHRoaXMsXG4gICAgICAgICAgICBzdGF0ZSA9IHMuc3RhdGUsXG4gICAgICAgICAgICBwcm9wcyA9IHMucHJvcHM7XG5cbiAgICAgICAgbGV0IHNpemUgPSBzdGF0ZS5zaXplO1xuXG4gICAgICAgIGxldCBtYWluRm9udFNpemUgPSBwYXJzZUludChzaXplICogMC4yKSxcbiAgICAgICAgICAgIHN1YkZvbnRTaXplID0gbWFpbkZvbnRTaXplIC8gNDtcblxuICAgICAgICBsZXQgYm9hcmRTdHlsZSA9IHtcbiAgICAgICAgICAgIHdpZHRoOiBgJHtzaXplfXB4YCxcbiAgICAgICAgICAgIGhlaWdodDogYCR7c2l6ZX1weGBcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPEFwQ2xvY2sgY2xhc3NOYW1lPXtjbGFzc25hbWVzKFwiYXAtZGlnaXRhbC1jbG9ja1wiLCBwcm9wcy5jbGFzc05hbWUpfT5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFwLWRpZ2l0YWwtY2xvY2stYm9hcmRcIiBzdHlsZT17Ym9hcmRTdHlsZX0+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYXAtZGlnaXRhbC1jbG9jay1ib2FyZC1pbm5lclwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJhcC1kaWdpdGFsLWNsb2NrLWRpc3BsYXlcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8QXBEaWdpdGFsQ2xvY2tNYWluRGlzcGxheSBob3Vycz17c3RhdGUuaG91cnN9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWludXRlcz17c3RhdGUubWludXRlc31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWNvbmRzPXtzdGF0ZS5zZWNvbmRzfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvbnRTaXplPXttYWluRm9udFNpemV9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25TaXplQ2hhbmdlPXtzLm9uTWFpbkRpc3BsYXlTaXplQ2hhbmdlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPEFwRGlnaXRhbENsb2NrU3ViRGlzcGxheSBkYXk9e3N0YXRlLmRheX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoPXtzdGF0ZS5sYWJlbFdpZHRofVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9udFNpemU9e3N1YkZvbnRTaXplfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L0FwQ2xvY2s+XG4gICAgICAgICk7XG4gICAgfSxcblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBMaWZlY3ljbGVcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICBjb21wb25lbnRXaWxsTW91bnQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgbGV0IHMgPSB0aGlzO1xuICAgICAgICBzLl9sb29waW5nID0gdHJ1ZTtcbiAgICB9LFxuXG4gICAgY29tcG9uZW50RGlkTW91bnQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgbGV0IHMgPSB0aGlzLFxuICAgICAgICAgICAgcHJvcHMgPSBzLnByb3BzO1xuXG4gICAgICAgIGxldCBwYWRaZXJvID0gQXBEaWdpdGFsTG9jay5wYWRaZXJvO1xuXG4gICAgICAgIGZ1bmN0aW9uIF9sb29wKCkge1xuICAgICAgICAgICAgaWYgKCFzLl9sb29waW5nKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbGV0IG5vdyA9IG5ldyBEYXRlKCk7XG5cbiAgICAgICAgICAgIHMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgICAgIGhvdXJzOiBwYWRaZXJvKG5vdy5nZXRIb3VycygpLCAyKSxcbiAgICAgICAgICAgICAgICBtaW51dGVzOiBwYWRaZXJvKG5vdy5nZXRNaW51dGVzKCksIDIpLFxuICAgICAgICAgICAgICAgIHNlY29uZHM6IHBhZFplcm8obm93LmdldFNlY29uZHMoKSwgMiksXG4gICAgICAgICAgICAgICAgZGF5OiBtb21lbnQobm93KS5mb3JtYXQoJ0xMJylcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZShfbG9vcCk7XG4gICAgICAgIH1cblxuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgcy5yZXNpemVDbG9jayk7XG4gICAgICAgIF9sb29wKCk7XG4gICAgICAgIHMucmVzaXplQ2xvY2soKTtcbiAgICB9LFxuXG4gICAgY29tcG9uZW50V2lsbFVubW91bnQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgbGV0IHMgPSB0aGlzO1xuICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigncmVzaXplJywgcy5yZXNpemVDbG9jayk7XG4gICAgICAgIHMuX2xvb3BpbmcgPSBmYWxzZTtcbiAgICB9LFxuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBIZWxwZXJcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgcmVzaXplQ2xvY2s6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgbGV0IHMgPSB0aGlzLFxuICAgICAgICAgICAgZWxtID0gUmVhY3RET00uZmluZERPTU5vZGUocyk7XG4gICAgICAgIGxldCBzaXplID0gbnVtY2FsLm1pbihlbG0ub2Zmc2V0V2lkdGgsIGVsbS5vZmZzZXRIZWlnaHQpO1xuICAgICAgICBzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIHNpemU6IHNpemVcbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIG9uTWFpbkRpc3BsYXlTaXplQ2hhbmdlOiBmdW5jdGlvbiAoc2l6ZXMpIHtcbiAgICAgICAgbGV0IHMgPSB0aGlzO1xuICAgICAgICBzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIGxhYmVsV2lkdGg6IHNpemVzLmlubmVyV2lkdGhcbiAgICAgICAgfSk7XG4gICAgfVxuXG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSBBcERpZ2l0YWxMb2NrO1xuIl19